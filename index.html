<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
	</head>
	<body>
            <h1>TEST CHATBOT</h1>

            <label for="espositoreId">Codice SIA Espositore:</label><br>
            <input type="text" id="espositoreId" name="Espositore Id" value="0097527">
            <br><br>

            <label for="edizione">Codice Edizione:</label><br>
            <input type="text" id="edizione" name="Codice Edizione" value="WEL24">

            <br><br><br>
            <button onclick="buttonClick()" id="button">Inizializza Chat</button>

            <script type='text/javascript'>
                function buttonClick() {
                    const espositoreId = document.getElementById("espositoreId").value;
                    const codiceEdizione = document.getElementById("edizione").value;

                    console.log('Espositore Id:', espositoreId)
                    console.log('Codice Edizione:', codiceEdizione)

                    initEmbeddedMessaging(espositoreId, codiceEdizione)
                }
            </script>

			<script type='text/javascript'>
				function initEmbeddedMessaging(espositoreId, codiceEdizione) {
					try {
						embeddedservice_bootstrap.settings.language = 'it'; // For example, enter 'en' or 'en-US'

                        window.addEventListener("onEmbeddedMessagingReady", () => {            
                            console.log( "Inside Prechat API!!" );
                            embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields( { "CodiceSIAEspositore" : espositoreId, "CodiceEdizione": codiceEdizione } );
                        });
			
						embeddedservice_bootstrap.init(
							'00D5t0000008hjC',
							'IEG_Chat',
							'https://iegexpo--uat.sandbox.my.site.com/ESWIEGChat1719926059932',
							{
								scrt2URL: 'https://iegexpo--uat.sandbox.my.salesforce-scrt.com'
							}
						);
                        document.getElementById("button").style = 'display: none';
					} catch (err) {
						console.error('Error loading Embedded Messaging: ', err);
					}
				};
			</script>
			<script type='text/javascript' src='https://iegexpo--uat.sandbox.my.site.com/ESWIEGChat1719926059932/assets/js/bootstrap.min.js'></script>
	</body>
</html>
